{"componentChunkName":"component---src-templates-blog-post-js","path":"/installing-outlook-add-in-for-specific-users/","result":{"data":{"markdownRemark":{"id":"9cf5ce93-780c-597e-99e5-8e58654dc9b6","parent":{"relativePath":"blog/2017-08-10-installing-outlook-add-in-for-specific-users.md"},"fields":{"slug":"/installing-outlook-add-in-for-specific-users/"},"html":"<blockquote>\n<p><strong>NOTE</strong>: I was using Office 365 so the cmdlets below should work in Exchange Online. For on-premises installations, you might need to get the user IDs in a different way.</p>\n<p>If you're using Office 365, you might want to have a look at <a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/publish/centralized-deployment\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Centralized Deployment</a>.</p>\n</blockquote>\n<p>Goal: to install Outlook add-in available only for specific users and to make it enable by default</p>\n<h3 id=\"1st-attempt\" style=\"position:relative;\"><a href=\"#1st-attempt\" aria-label=\"1st attempt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1st attempt:</h3>\n<p>If you open Exchange admin center > organization > add-ins and try to add it from there:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 226px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0870d8edd5434c90fa4e1460f40a178b/5f7d4/2017-08-10-16_24_04-add-ins-microsoft-exchange.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.15929203539822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABJ0AAASdAHeZh94AAAB8ElEQVQoz3VS246bMBD1/3/F9gvyBe1LHyq16ubWcAmQgMHhkgRiwBhf6UB2K3XVHlmjw8yc8YwHNE0T53x6h1Kq73sgQghrrTGmrmsp5fQvoLZtV6sVIeR2u8F3HMeUUq2167pgwzD89PJSFgWEoNZHMbjyPIcLIfXPtcAfjweErtfrXEUpu4g/ADHGhJR8HEchhVJSqYVIKDbK2Rprpdbg50KCB0JgRyF6xlDdNM9+YMhx5HwUfBggB+YcF4CftrTtOqMNhxjn0CAoGBvQg9Kn+JLh9evrOcEpTg77zTnGaZocdusiLzzH8Tz/HIU5yQ6Oezx6VVVBVXStGy7NqIzUVttJ28XC2HaC+go6slboSRoLaUJbyIQDnqbtES7vaSPyTru4XB/jfVzuT2QfpQ6uvLT8cQh8cr90KqOCtJJQWTAD5NKqU0lRVt0JFWWnnDP5tj7sTsSNL993zi7KQPzTCd2kKHqdU5GDhoptkKX1UPY6rii6Nw9oBroyy+rM3PlM7PRG5tc20LmBWVo2fP7yNYpT8Dddj5p5n7PwQtLddnvGaZLEnvNrfq/4tN5s4G2nt2rzwThrmga+e/YUL0HYTd/1sGTIZgzIvPVhGKb/gA0DwjiFf8j3/WMQhFEUBMGTHBcShKH/N7zlAFzP+w1pUdyQdv/PyQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2017-08-10-16_24_04-add-ins-microsoft-exchange.png\"\n        title=\"2017-08-10-16_24_04-add-ins-microsoft-exchange.png\"\n        src=\"/static/0870d8edd5434c90fa4e1460f40a178b/5f7d4/2017-08-10-16_24_04-add-ins-microsoft-exchange.png\"\n        srcset=\"/static/0870d8edd5434c90fa4e1460f40a178b/5f7d4/2017-08-10-16_24_04-add-ins-microsoft-exchange.png 226w\"\n        sizes=\"(max-width: 226px) 100vw, 226px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>you’ll not be able to set it provided only to specific user. You can only set its default state for enabled/disabled or make it available to nobody:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 433px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c1e2d8a95a7f1cc4f0de2207c772e133/55fc0/2017-08-10-16_29_20-edit-add-in-settings.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.027713625866056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABJ0AAASdAHeZh94AAAA0UlEQVQY041QSW7EMAzz/x9Z9NCBNy12DpOJl7q0JrcCRZmDZToSSbmPz68QIiDCRMTCRdX7TZVSmFlUVVREwINMKYKcc6613JiztdZ766NbgbJd+O66jzGM27fruvllcDFFjK4GhjYz3tf/4EotTBl2tkMW7z08wjBRxtBh9r5/4W4OJMiBxrKhOWdGPlW2FfQ+/lJ+RAox5QwlglRKZkEk502+zhOZm+3hjdabraBB353PJ36FYegcxwFRxK61oHlf95pFS8UZgre5TDsgw9QP6OCRI+vtdiAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2017-08-10-16_29_20-edit-add-in-settings.png\"\n        title=\"2017-08-10-16_29_20-edit-add-in-settings.png\"\n        src=\"/static/c1e2d8a95a7f1cc4f0de2207c772e133/55fc0/2017-08-10-16_29_20-edit-add-in-settings.png\"\n        srcset=\"/static/c1e2d8a95a7f1cc4f0de2207c772e133/55fc0/2017-08-10-16_29_20-edit-add-in-settings.png 433w\"\n        sizes=\"(max-width: 433px) 100vw, 433px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<!--more-->\n<h3 id=\"2nd-attempt\" style=\"position:relative;\"><a href=\"#2nd-attempt\" aria-label=\"2nd attempt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2nd attempt:</h3>\n<p>This time using Windows PowerShell:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">New-App</span> <span class=\"token operator\">-</span>Url <span class=\"token string\">\"https://xxxxxxxx.azurewebsites.net/app-manifest-tst.xml\"</span> <span class=\"token operator\">-</span>OrganizationApp <span class=\"token operator\">-</span>UserList robert@domain<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">,</span>peter@domain<span class=\"token punctuation\">.</span>com <span class=\"token operator\">-</span>DefaultStateForUser Enabled</code></pre></div>\n<p>Surprisingly, this will install add-in enabled by default for all users.</p>\n<h3 id=\"3rd-attempt\" style=\"position:relative;\"><a href=\"#3rd-attempt\" aria-label=\"3rd attempt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3rd attempt:</h3>\n<p>This time I read the documentation more carefully and added this:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token operator\">-</span>ProvidedTo SpecificUsers</code></pre></div>\n<p>Full command:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">New-App</span> <span class=\"token operator\">-</span>Url <span class=\"token string\">\"https://xxxxxxxx.azurewebsites.net/app-manifest-tst.xml\"</span> <span class=\"token operator\">-</span>OrganizationApp <span class=\"token operator\">-</span>UserList robert@domain<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">,</span>piotr@domain<span class=\"token punctuation\">.</span>com <span class=\"token operator\">-</span>DefaultStateForUser Enabled <span class=\"token operator\">-</span>ProvidedTo SpecificUsers</code></pre></div>\n<p>This time it worked correctly.</p>\n<p>To enabled add-in for another user you need to add him/her to UserList:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$t</span> = <span class=\"token function\">Get-App</span> <span class=\"token operator\">-</span>OrganizationApp <span class=\"token punctuation\">|</span><span class=\"token function\">Where-Object</span> Displayname <span class=\"token operator\">-eq</span> <span class=\"token string\">\"Add-in Name\"</span>\n<span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList = <span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList <span class=\"token operator\">+</span> <span class=\"token string\">\"marcin@domain.com\"</span>\n<span class=\"token variable\">$t</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Set-App</span> <span class=\"token operator\">-</span>UserList <span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList <span class=\"token operator\">-</span>OrganizationApp</code></pre></div>\n<p>For Exchange on-premises, get <code class=\"language-text\">DistinguishedName</code> another way (credits to @Kevin Moore):</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$userToAdd</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">Get-ADUser</span> YourADAccountHere<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>DistinguishedName\n<span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList = <span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList <span class=\"token operator\">+</span> <span class=\"token variable\">$userToAdd</span></code></pre></div>\n<p>If you receive an error ‘There are multiple recipients matching the identity’ you can use the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span>=0<span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-lt</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span>+<span class=\"token operator\">+</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList<span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">Get-Mailbox</span> <span class=\"token variable\">$t</span><span class=\"token punctuation\">.</span>UserList<span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span>RecipientTypeDetails UserMailbox<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>userprincipalname</code></pre></div>","frontmatter":{"date":"2017-08-10 10:11","title":"Installing Outlook add-in for specific users","description":"Goal: to install Outlook add-in available only for specific users and to make it enable by default","tags":["powershell","microsoft 365","exchange"]}}},"pageContext":{"id":"9cf5ce93-780c-597e-99e5-8e58654dc9b6"}},"staticQueryHashes":["2483265550"]}