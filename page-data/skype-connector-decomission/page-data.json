{"componentChunkName":"component---src-templates-blog-post-js","path":"/skype-connector-decomission/","result":{"data":{"markdownRemark":{"id":"b127dbb7-cd7b-51c3-bbd2-93da3430a65e","parent":{"relativePath":"blog/2020-12-18-skype-connector-decomission.md"},"fields":{"slug":"/skype-connector-decomission/"},"html":"<p>Microsoft is decomissioning Skype for Business Online Connector next year (at time of posting this, due date is Feb 15, 2021). The announcement MC230065 appeared in Message Center:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 533px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6e6327a2092b6abb6e83ef0eb746f245/a1aa0/skypeonlinedecom0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147.5583864118896%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsTAAALEwEAmpwYAAADtUlEQVRIx51Vi3LbRgzk/39N8w2N6zq1HNux5XEsVaolii9R4vspcoPFkbaSxpXTm9nBHQ6HA3EL0Lq+vsEfZ2eYTu8xvZ9iPp/hanKJiz/PcSlyMpng4eEB5+dn+Pjxd3y++iy2U9zcXGNydYnb21tcXFzg+XkFDmt6d4cPv33AmTj969MnxePjI3a7Hfb7PcIwRJIkiKJI15RpmmK73SLchbrv+z6yPDcOXWeD2dMMy+VS5BPms5kaHw4HNE0zoFZQR9R1jZ+Nvu9h7SWSbRDoTby5bVsURaHRjJHFcSyIkGWZguuu69XBMTTCsixBpGmChjcfbf7nGO1+cGrV8kllVSPPC5UV50WJbvDZv4G3htU3FbqqAET2dTXIUtEN8jSGM20Dq3OXyL/eIJp9Qfz0Bfuvt4hEpvN7JPM79M4CEBu4iwHLo/XR3Jmj33uSwyxFnsSgzETmkkuuiSI1e4XsFaIvj2SZZ2rLvbrIkcmjdYwwDLdwXA+u62LjODJ3de5sHHieD9fjngdfmEA9OUddsN2qLc9shSEbsW+EIVYoG67rqDHnvhjzEIm9sW0E4sgRrrrjRXQQ+LDXNtarFWx7LZdvhCWZeRRuerxZHNF4lJ7nqt51zGXkJPkXCRLlZfxSOVynSWocZpInEjqVA7mUT0EIsUngsixUR56+Z5hKkVt8P9CbThmfgkbYdR1yeSk63u93mrtYomXNvqdiRpsXh6xdlt1K2s9mI4lerzV/gTwMH4SNYCxPzsc108KzP0avEdZVpUlPh3xmEjGTTh1zqUkf9FwzPUQl5/7lkJ9ImrBleQNlIvn8INia1xYOsoW9d+grj+2JXIrjRFOgdFCqmIbKS4xdIvr4Jco4igd9rOmwGJFtb4TEhqDsi8yfLXONeOAlSe77noL89DxTXYE/8FfOMKcWo9ntzAu/1Yl/ZVjMHaF5k1vC0FCHOt7adf2vOdRXY7uXPDE3r20/+e6l+SWp2piKIo73eKYV7prm4LgakTPkjfka65mdhfQohXfk31iKpejG+ViqLAZr5Nxrvb42+b7vTjT8n3wyHfGfWpQVmkOHVnJGeRBJtNQNOLAI2u/XzbB+/aeIMkpLPAcFll6GpW/wT5Bj4aWYu6nO19tc9Qux+Vt0C5nPnFR1M1n7cWUqhb/BompghwWCpIK7L7GS+WZnYAuoUxlJLpsDKkFZH5DXZl7ULbKqlT+l1nKvYWdlq8ZFbVA3nRibT+QhSuI0D4eowrTWsP1IXrJu/3df/AYHIQU/ibXvmgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Microsoft announcement about decomission\"\n        title=\"Microsoft announcement about decomission\"\n        src=\"/static/6e6327a2092b6abb6e83ef0eb746f245/a1aa0/skypeonlinedecom0.png\"\n        srcset=\"/static/6e6327a2092b6abb6e83ef0eb746f245/1f09d/skypeonlinedecom0.png 471w,\n/static/6e6327a2092b6abb6e83ef0eb746f245/a1aa0/skypeonlinedecom0.png 533w\"\n        sizes=\"(max-width: 533px) 100vw, 533px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The resource linked to the announcement about how to <a href=\"https://docs.microsoft.com/en-us/microsoftteams/teams-powershell-move-from-sfbo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Move from Skype for Business Online Connector to the Teams PowerShell module</a> is not very detailed. You might wonder how to check if you (as Microsoft 365 admin) need to take any action.</p>\n<h2 id=\"is-the-module-used-in-my-tenant\" style=\"position:relative;\"><a href=\"#is-the-module-used-in-my-tenant\" aria-label=\"is the module used in my tenant permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Is the module used in my tenant?</h2>\n<p>Based on <a href=\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/SignIns\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Azure AD sign-in logs</a> you can determine if anyone from your organization signed in to Skype for Business Online connector recently.</p>\n<p>To find out which filter to use, let's check the entries generated by each module connection.</p>\n<p>Skype for Business module sign-in:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1187px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e8361b10e97adc8fa4068e0fddd758b5/cec12/skypeonlinedecom1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.038216560509554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQoz22SP2/CMBDF851BiIHyASLExo4UIQYklsDAABmgUpWBAcgAVWFGDVBI8z/2652pUgv6pJNPPt/vni0bX0GEOElRFAXiOEYYhmrNsgxJkkCIAp7nwXEcLBYLtfq+jzRNVZ37dBm8yc2swWCAVquFbrerwFxj9Xo9VKtVNJtN1Ot1vO92yPO8rD8BuZknTqdT9Pt9jMdj5ZKDZVkWKpUKXhoN1Go1bLdbtc+OTdNEp9NBu93GcDi8AxnGLnX7khxE/idEFMFbLvFKw9z5HG+zGa7nszqzI7Bt25hMJhiNRnBdF4ZuV0p5D8oFOz8eIWlYeLkgOJ2QExzsmoZJ/C+jhGjBEuQ2ul4V8JuANwIWBONBUojSgKBcD0OHPOYJwVj7wwHrzQYf+z39iOTvrH6r3zAeLZcOaVpwu6l3Xa9WmNHbcfCXKc/J54v/ANNqU7wGXwpFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Skype for Business module sign-in entry\"\n        title=\"Skype for Business module sign-in entry\"\n        src=\"/static/e8361b10e97adc8fa4068e0fddd758b5/cec12/skypeonlinedecom1.png\"\n        srcset=\"/static/e8361b10e97adc8fa4068e0fddd758b5/1f09d/skypeonlinedecom1.png 471w,\n/static/e8361b10e97adc8fa4068e0fddd758b5/f1901/skypeonlinedecom1.png 942w,\n/static/e8361b10e97adc8fa4068e0fddd758b5/cec12/skypeonlinedecom1.png 1187w\"\n        sizes=\"(max-width: 1187px) 100vw, 1187px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Teams module sign-in:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1211px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8034af32b2fab903c82c32bdc5210740/bb3b7/skypeonlinedecom2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.004246284501065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz3VSTWvCQBDdn6yVehOkHgXBo3g1l1L05Ef9F9ZLohIsWvEjKiZx4xqT58yWhFTqg8cmM5OZN28jZKAQXq+I4xgJoijClWKXywVKqfQMgkCTa5lc90ghqYAxGo3Q7/cxGAxgWZZuwAXbzQb1el2zVquh2WzC2e3geR7CMMQjhJRSPxiGgVwuh3w+j06n86uC4j+rFV6LRc2XQgFvlQocx9F527YxmUwwm80wnU71u/B9X6+3WCxgmqZWt9/voUiBcl3slkt80DDme6uFbrsNj+KMRqOBUqmECg0pl8uoVqsQLDvZPwuflJ23W8Q00F2v4RFdWj+kdUmBrjmdTjgcDimPxyNEtkliNENSI0X+RrcbXPpQns8IyJ6QvE0u5T+IJJklgy9FkRJev9vr4XM4xNd4nA5+xj8KkWnIvwd7yycbb1kmvufzNP9M5R3SnVELs095oAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MS Teams module sign-in entry\"\n        title=\"MS Teams module sign-in entry\"\n        src=\"/static/8034af32b2fab903c82c32bdc5210740/bb3b7/skypeonlinedecom2.png\"\n        srcset=\"/static/8034af32b2fab903c82c32bdc5210740/1f09d/skypeonlinedecom2.png 471w,\n/static/8034af32b2fab903c82c32bdc5210740/f1901/skypeonlinedecom2.png 942w,\n/static/8034af32b2fab903c82c32bdc5210740/bb3b7/skypeonlinedecom2.png 1211w\"\n        sizes=\"(max-width: 1211px) 100vw, 1211px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>From that point you probably know, what to do. Simply go to <a href=\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/SignIns\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sign-in logs</a> and add proper filter:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1597px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7779ade27f2290b667c2e0aae180715d/6dd26/skypeonlinedecom3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.751592356687897%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9UlEQVQY032QwW6CQBCGeWC5it71RnwJHsCDRx4CUxHjzcRLW9lmWVhYYJevS3vRQzvJly8z+TOZTFCqAdkYhNSUHvFVI4RCyhZVG5TqaDpLY9wrnUN7t/30QiAqzbuofMj6wIhRGu376lMgP0oaITG9469yE0zTr2eCqq7RneF2u5FlGefz+Ye304nj8cjJe+Z6vZJ7Xy4XiqIgz3Pu9zt93zMOA22rsXb0C6uKwQ/3+z2LxYL1ek20XBJFEcsnP7NarQjDkCRJaOqGx+PhX6NwzhHU/sJxHEnTlM1mw263I47jf5kz2+2Ww+FAbwzzUfMeay3fQO9auEVFjAkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Filtered sign-in logs\"\n        title=\"Filtered sign-in logs\"\n        src=\"/static/7779ade27f2290b667c2e0aae180715d/6dd26/skypeonlinedecom3.png\"\n        srcset=\"/static/7779ade27f2290b667c2e0aae180715d/1f09d/skypeonlinedecom3.png 471w,\n/static/7779ade27f2290b667c2e0aae180715d/f1901/skypeonlinedecom3.png 942w,\n/static/7779ade27f2290b667c2e0aae180715d/6dd26/skypeonlinedecom3.png 1597w\"\n        sizes=\"(max-width: 1597px) 100vw, 1597px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"what-to-do-next\" style=\"position:relative;\"><a href=\"#what-to-do-next\" aria-label=\"what to do next permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What to do next?</h2>\n<p>Next, you need to replace the existing modules. Microsoft suggest to replace your <code class=\"language-text\">Import-Module</code> cmdlets to reference Teams module. I have a feeling they forgot that <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_modules?view=powershell-7.1#module-auto-loading\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PowerShell supports autoloading since version 3.0</a> 😉</p>\n<p>Once you determine affected users and they know which machines they use for scripting, you need to replace the legacy module. To find where you have your module, use the following PowerShell cmdlet:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token punctuation\">(</span><span class=\"token function\">Get-Module</span> lynconlineconnector<span class=\"token punctuation\">,</span>skypeonlineconnector <span class=\"token operator\">-</span>ListAvailable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ModuleBase</code></pre></div>\n<p>Once you have the folders located, move them to another location (I advise to not delete them until you confirmed the new module is working fine). Then we proceed to Microsoft Teams module installation. According to <a href=\"https://docs.microsoft.com/en-gb/MicrosoftTeams/teams-powershell-release-notes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Teams PowerShell Release Notes</a> the newest GA version 1.1.6 already supports Skype for Business Online Connector integration. The following cmdlet can be used:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># For everyone using the machine, requires admin rights</span>\n<span class=\"token function\">Install-Module</span> microsoftteams\n<span class=\"token comment\"># For current user only, no admin rights needed</span>\n<span class=\"token function\">Install-Module</span> microsoftteams <span class=\"token operator\">-</span>Scope CurrentUser</code></pre></div>\n<blockquote>\n<p><strong>NOTE</strong>: If you use <code class=\"language-text\">-UserName</code> parameter for <code class=\"language-text\">New-CsOnlineSession</code>, make sure to update your scripts. This parameter <a href=\"https://docs.microsoft.com/en-us/powershell/module/skype/new-csonlinesession?view=skype-ps#parameters\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">was deprecated</a> and it's no longer available in Teams PowerShell module.</p>\n</blockquote>\n<p>To verify installation was successful, connect using <code class=\"language-text\">New-CsOnlineSession</code> and verify the correct client id appears in sign-in logs. For best results, monitor your script in the following days, to make sure that there are no errors. Then remove the legacy modules from the machine.</p>","frontmatter":{"date":"2020-12-18 10:23","title":"Skype for Business Online connector decomission","description":"After Microsoft announced they'll decomission Skype for Business Online module, I'm sharing the instruction of how to replace it with new module efficiently.","tags":["skype for business","teams","powershell"]}}},"pageContext":{"id":"b127dbb7-cd7b-51c3-bbd2-93da3430a65e"}},"staticQueryHashes":["2483265550"]}