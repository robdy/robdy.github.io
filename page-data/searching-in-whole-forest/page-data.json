{"componentChunkName":"component---src-templates-blog-post-js","path":"/searching-in-whole-forest/","result":{"data":{"markdownRemark":{"id":"3013b072-c1f9-54ee-abb6-260f44aecbc4","parent":{"relativePath":"blog/2017-12-19-searching-in-whole-forest.md"},"fields":{"slug":"/searching-in-whole-forest/"},"html":"<p>When you want to find a user in Active Directory you usually use:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-ADUser</span> <span class=\"token operator\">-</span><span class=\"token keyword\">Filter</span> <span class=\"token punctuation\">{</span>SamAccountName <span class=\"token operator\">-eq</span> <span class=\"token string\">\"User1\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>However, if you are in multi-domain environment and you’re looking for the user from another domain you’ll receive the error:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-ADUser</span> : Cannot find an object with identity: <span class=\"token string\">'User1'</span> under: <span class=\"token string\">'DC=europe,DC=domain,DC=com'</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>To resolve this issue you have to send your query to Global Catalog directly. If your Domain Controller is also Global Catalog you can do it by specyfying server with port 3268:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-ADUser</span> <span class=\"token operator\">-</span><span class=\"token keyword\">Filter</span> <span class=\"token punctuation\">{</span>SamAccountName <span class=\"token operator\">-eq</span> <span class=\"token string\">\"User1\"</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>Server <span class=\"token string\">\"DC1:3268\"</span></code></pre></div>\n<p>If you don’t know the name of your DC you can try to use the DC you authenticates to:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-ADUser</span> <span class=\"token operator\">-</span><span class=\"token keyword\">Filter</span> <span class=\"token punctuation\">{</span>SamAccountName <span class=\"token operator\">-eq</span> <span class=\"token string\">\"User1\"</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>Server <span class=\"token string\">\"<span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">Get-ADDomainController</span><span class=\"token punctuation\">)</span></span>.Name):3268\"</span></code></pre></div>","frontmatter":{"date":"2017-12-19 10:11","title":"Searching in whole forest","description":"Here's how to search for users in multi-domain environment.","tags":["powershell","active directory"]}}},"pageContext":{"id":"3013b072-c1f9-54ee-abb6-260f44aecbc4"}},"staticQueryHashes":["2483265550"]}