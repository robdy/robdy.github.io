{"componentChunkName":"component---src-templates-blog-post-js","path":"/all-available-numbers-calling-plan/","result":{"data":{"markdownRemark":{"id":"b558540d-ab51-5f66-9f6b-be38784228e9","parent":{"relativePath":"blog/2021-02-17-all-available-numbers-calling-plan.md"},"fields":{"slug":"/all-available-numbers-calling-plan/"},"html":"<blockquote>\n<p><strong>NOTE</strong>: The article below doesn't apply to numbers provided via Direct Routing</p>\n</blockquote>\n<p>We'll use Teams PowerShell module. Connecting to Skype for Business Online is as usual:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$sfbSession = New-CsOnlineSession\nImport-PSSession $sfbSession</code></pre></div>\n<blockquote>\n<p><strong>NOTE</strong>: If you still use Skype for Business Online module, remember that it's being decomissioned. I have <a href=\"/skype-connector-decomission/\">an article showing how to migrate to new module</a>.</p>\n</blockquote>\n<p>The cmdlet we'll be using is <a href=\"https://docs.microsoft.com/en-us/powershell/module/skype/get-csonlinetelephonenumber?view=skype-ps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Get-CsOnlineTelephoneNumber</code></a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$allNumbers</span> = <span class=\"token function\">Get-CsOnlineTelephoneNumber</span> <span class=\"token operator\">-</span>IsNotAssigned <span class=\"token operator\">-</span>ResultSize 2147483647 <span class=\"token operator\">-</span>InventoryType Subscriber</code></pre></div>\n<p>Parameters we use:</p>\n<ul>\n<li><code class=\"language-text\">-IsNotAssigned</code> - self explanatory</li>\n<li><code class=\"language-text\">-ResultSize 2147483647</code> - there's no support for <strong>Unlimited</strong>, in contrary to other  Microsoft 365 cmdlets, so we specify maximum value (based on <a href=\"https://docs.microsoft.com/en-us/powershell/module/skype/get-csonlinetelephonenumber?view=skype-ps#parameters\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the docs</a>)</li>\n<li><code class=\"language-text\">-InventoryType Subscriber</code> - based on the docs, it's used to display numbers, which can be assigned to users.</li>\n</ul>\n<p>Now we have our numbers saved into variable. We can process them, as we need. </p>\n<p>Few examples:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># Group by city</span>\n<span class=\"token variable\">$allNumbers</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Group-Object</span> CityCode <span class=\"token operator\">-</span>NoElement\n\n<span class=\"token comment\"># List all numbers</span>\n<span class=\"token variable\">$allNumbers</span><span class=\"token punctuation\">.</span>Id\n\n<span class=\"token comment\"># Copy all numbers to clipboard</span>\n<span class=\"token variable\">$allNumbers</span><span class=\"token punctuation\">.</span>Id <span class=\"token punctuation\">|</span> clip</code></pre></div>","frontmatter":{"date":"2021-02-17 19:12","title":"Get all available user numbers in Calling Plans","description":"From time to time we need to verify how many available numbers are there in your directory. Here's how to do it.","tags":["powershell","teams","calling plan"]}}},"pageContext":{"id":"b558540d-ab51-5f66-9f6b-be38784228e9"}},"staticQueryHashes":["2483265550"]}